(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{6429:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return e(4759)}])},4759:function(n,t,e){"use strict";e.r(t);var r=e(1010),u=e(1309),i=e(414),o=e(5893),l=e(8949),a=e(828),c=e(1163),s=e(7294),d=e(9055),f=e(2253),v=e(5791),h=e(3437);t.default=(0,a.Pi)(function(){var n=(0,c.useRouter)(),t=(0,v.Yh)(),e=(0,u._)((0,f.dQ)(),2),a=e[0],m=e[1],g=(0,u._)((0,s.useState)(null),2),p=g[0],_=g[1],b=(0,u._)((0,s.useState)(null),2),w=b[0],y=b[1],M=(0,s.useCallback)(function(){(0,l.z)((0,r._)(function(){var e,r,u;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),t.isSubmitting=!0,[4,h.Z.post("/accounts/ClientLogin",{Email:p,Passwd:w})];case 1:if(e=i.sent(),r={},e.split("\n").filter(function(n){return n}).forEach(function(n){var t=n.indexOf("=");t>0?r[n.substr(0,t)]=n.substr(t+1):r[n]=!0}),!r.Auth)throw Error("account or password incorrect");return m(r.Auth),n.back(),[3,4];case 2:return console.warn("LoginPage.login error:",u=i.sent()),(0,d.Am)("login failed: ".concat(u)),[3,4];case 3:return t.isSubmitting=!1,[7];case 4:return[2]}})}))},[w,t,n,m,p]);return(0,o.jsxs)("div",{style:{margin:16,display:"grid",gridTemplateColumns:"auto 1fr",rowGap:16,columnGap:16},children:[(0,o.jsx)("div",{children:"account"}),(0,o.jsx)("input",{value:null!=p?p:"",onChange:function(n){return _(n.target.value||null)}}),(0,o.jsx)("div",{children:"password"}),(0,o.jsx)("input",{type:"password",value:null!=w?w:"",onChange:function(n){return y(n.target.value||null)}}),(0,o.jsx)("button",{onClick:M,disabled:t.isSubmitting,style:{gridColumn:"1 / span 2",padding:8,fontSize:14},children:"login"}),(0,o.jsx)("div",{style:{gridColumn:"1 / span 2"},children:null==a?void 0:a.length})]})})},2253:function(n,t,e){"use strict";e.d(t,{B1:function(){return S},K4:function(){return M},WX:function(){return y},YM:function(){return I},dQ:function(){return g},fv:function(){return _},jx:function(){return b},tW:function(){return p}});var r=e(1010),u=e(8564),i=e(2267),o=e(567),l=e(4932),a=e(1309),c=e(4586),s=e(414),d=e(7294),f=e(8767),v=e(906),h=e(3437),m=e(2070),g=(0,v.Z)("token"),p=(0,v.Z)("recentlyReadItems");function _(n){return(0,d.useMemo)(function(){return(0,v.Z)("randomItems:".concat(n))},[n])}function b(){var n=(0,a._)(g(),1)[0],t=(0,f.useQuery)("/reader/api/0/tag/list?output=json",{enabled:!!n,select:function(n){return n.tags.filter(function(n){return/\/label\//.test(n.id)})}});return(0,m.p)(t.error),(0,l._)((0,o._)({},t),{folders:t.data})}function w(){var n=(0,a._)(g(),1)[0],t=(0,f.useQuery)("/reader/api/0/unread-count?output=json",{enabled:!!n,select:function(n){return n.unreadcounts}});return(0,l._)((0,o._)({},t),{unreadCounts:t.data})}function y(n){var t,e,r,u=null===(t=n.id)||void 0===t?void 0:t.replace(/\d+/,"-"),i=w();return(0,l._)((0,o._)({},i),{unreadsCount:null===(e=null===(r=i.unreadCounts)||void 0===r?void 0:r.find(function(n){return n.id===u}))||void 0===e?void 0:e.count})}function M(n){var t,e=w().unreadCounts;return null===(t=null==e?void 0:e.find(function(t){return t.id===n}))||void 0===t?void 0:t.count}function S(n){var t,e,u,i=n.folderId,d=n.isReloading,v=(t=w().unreadCounts,((e=(0,a._)(g(),1)[0],u=(0,f.useQuery)("/reader/api/0/subscription/list?output=json",{enabled:!!e,select:function(n){return n.subscriptions.sort(function(n,t){return n.id.localeCompare(t.id)})}}),(0,l._)((0,o._)({},u),{allSubscriptions:u.data})).allSubscriptions||[]).filter(function(n){var e,r;return(null===(e=n.categories)||void 0===e?void 0:e.some(function(n){return n.id===i}))&&(null===(r=null==t?void 0:t.find(function(t){return t.id===n.id}))||void 0===r?void 0:r.count)>0})),m=w().unreadCounts,p=_(i),b=(0,a._)(p([]),2),y=b[0],M=b[1],S=(0,f.useQuery)(["randomItems",i,{localRandomItems:y}],(0,r._)(function(){var n,t,e,u,i,f,g,p,_,b,w,S,I,j,x,k,E,P,Q,R,T,Z,N,A,J,O;return(0,s.Jh)(this,function(W){switch(W.label){case 0:var X;if(y.length>2)return[2,y];for(n=new Set(y.map(function(n){return n.feedId})),(t=v.filter(function(t){return(null==t?void 0:t.id)&&!n.has(t.id)})).length<7&&(t=v.filter(function(n){return null==n?void 0:n.id})),e=[],u=0;e.length<7&&t.length>0;u=(u+1)%t.length)f=t[u],g=(Math.abs(Math.log(((null===(i=null==m?void 0:m.find(function(n){return n.id===f.id}))||void 0===i?void 0:i.count)||0)+1)/C(500,12)-4)+1)/t.length,!e.includes(f)&&Math.random()<g&&(e.push(f),t.splice(u,1));return[4,Promise.all(e.filter(function(n){return null==n?void 0:n.id}).map((X=(0,r._)(function(n){var t,e,u,i,d;return(0,s.Jh)(this,function(f){switch(f.label){case 0:var v;return e=Math.ceil((null===(t=null==m?void 0:m.find(function(t){return t.id===n.id}))||void 0===t?void 0:t.count)/7),[4,Promise.all(["o","n"].map((v=(0,r._)(function(t){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return[4,h.Z.get("/reader/api/0/stream/items/ids",{output:"json",s:n.id,xt:"user/-/state/com.google/read",r:t,n:e})];case 1:return[2,r.sent().itemRefs]}})}),function(n){return v.apply(this,arguments)})))];case 1:return i=(u=a._.apply(void 0,[f.sent(),2]))[0],d=u[1],[2,(0,c._)(i).concat((0,c._)(d)).map(function(t){return(0,l._)((0,o._)({},t),{feedId:n.id})})]}})}),function(n){return X.apply(this,arguments)})))];case 1:p=W.sent(),_=[],b=!0,w=!1,S=void 0;try{for(I=p[Symbol.iterator]();!(b=(j=I.next()).done);b=!0)for(Q=0,x=j.value,E=(null===(k=null==m?void 0:m.find(function(n){var t;return n.id===(null==x?void 0:null===(t=x[0])||void 0===t?void 0:t.feedId)}))||void 0===k?void 0:k.count)||0,P=Math.max(1,Math.floor(Math.log(E)/Math.log(C(400,2))));Q<P&&x.length>0;)R=Math.floor(Math.random()*x.length),T=(0,a._)(x.splice(R,1),1)[0],_.some(function(n){return n.id===T.id})||(_.push(T),Q+=1)}catch(n){w=!0,S=n}finally{try{b||null==I.return||I.return()}finally{if(w)throw S}}for(N=(Z=(0,c._)(_)).length-1;N>0;N--)J=[Z[A=Math.floor(Math.random()*(N+1))],Z[N]],Z[N]=J[0],Z[A]=J[1];return M(O=(0,c._)(d?[]:(0,c._)(y)).concat((0,c._)(Z)).filter(function(n,t,e){return e.findIndex(function(t){return t.id===n.id})===t})),[2,O]}})}),{enabled:(null==v?void 0:v.length)>0});return(0,l._)((0,o._)({},S),{randomItems:S.data})}function C(n,t){return Math.pow(Math.E,Math.log(n)/t)}function I(n){var t,e=(t=n.id,(0,d.useMemo)(function(){return(0,v.Z)("item:".concat(t))},[t])),r=(0,a._)(e(),2),u=r[0],i=r[1],c=!u&&!n.crawlTimeMsec,s=(0,f.useQuery)("/reader/api/0/stream/items/contents?output=json&i=".concat(n.id),{enabled:c,select:function(n){return n.items[0]}}),h=u||(n.crawlTimeMsec?n:(0,l._)((0,o._)({},s.data),{id:n.id}));if(!u&&h.crawlTimeMsec&&(i(h),localStorage.length>222))for(var m=7;m>=0;){var g=localStorage.key(Math.random()*localStorage.length);(null==g?void 0:g.startsWith("item:"))&&(localStorage.removeItem(g),m--)}return(0,l._)((0,o._)({},s),{item:h})}new(function(){function n(){(0,u._)(this,n)}return(0,i._)(n,[{key:"get",value:function(n){return localStorage.getItem(n)}},{key:"delete",value:function(n){localStorage.removeItem(n)}},{key:"set",value:function(n,t){localStorage.setItem(n,t)}}]),n}())},2070:function(n,t,e){"use strict";e.d(t,{p:function(){return i}});var r=e(7294),u=e(9055);function i(n){var t,e=(t=(0,r.useRef)(),(0,r.useEffect)(function(){t.current=n},[n]),t.current);(0,r.useEffect)(function(){n&&!e&&(0,u.Am)(String(n))},[n,e])}}},function(n){n.O(0,[723,774,888,179],function(){return n(n.s=6429)}),_N_E=n.O()}]);