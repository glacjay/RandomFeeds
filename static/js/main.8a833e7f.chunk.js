(this["webpackJsonprandom-feeds"]=this["webpackJsonprandom-feeds"]||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),o=n(9),i=n(19),s=n(23),c=n.n(s),l=n(12),u=n(18),d=n.n(u),m=n(0),f=n.n(m),v=n(16),p=n(5),b=n(24);t.default=Object(l.a)((function(e){var t,n,r=Object(p.c)(),s=d.a.parse(e.location.search.slice(1)).id,l=null===(t=r.folders)||void 0===t?void 0:t.find((function(e){return e.id===s}));f.a.useEffect((function(){r.loadItems({folderId:s})}),[r,r.token,s]);var u=f.a.useState(!1),m=Object(i.a)(u,2),g=m[0],h=m[1];return f.a.createElement("div",{className:"flex-column",style:{paddingBottom:4}},f.a.createElement("div",{style:{margin:"4px 4px 0"}},null===l||void 0===l?void 0:l.id,"\uff1a",null===l||void 0===l?void 0:l.unreadCount),null===l||void 0===l||null===(n=l.randomItems)||void 0===n?void 0:n.map((function(e){return f.a.createElement("div",{style:{margin:4,marginBottom:0,border:"1px solid black",borderRadius:4,padding:8}},f.a.createElement(v.b,{key:e.id,to:"/Item?folderId=".concat(s,"&id=").concat(e.id)},f.a.createElement("div",null,e.title),f.a.createElement("div",{className:"flex-row align-center",style:{marginTop:8,justifyContent:"space-between",fontSize:12,color:"gray"}},f.a.createElement("div",null,e.origin.title," | ",e.author),f.a.createElement("div",null,c()(1e3*e.updated).format("YYYY-MM-DD HH:mm")))),f.a.createElement("div",{className:"flex-row align-center",style:{marginTop:8,justifyContent:"flex-end"}},f.a.createElement(b.a,{item:e,isSubmitting:g,setIsSubmitting:h})))})),f.a.createElement("div",{style:{height:50}}),f.a.createElement("div",{className:"flex-row",style:{position:"fixed",bottom:0,left:0,right:0,zIndex:7,height:50}},f.a.createElement("button",{onClick:function(){h(!0),r.loadItems({folderId:s,reloadItems:!0}),h(!1)},disabled:g,style:{flex:1}},"reload folder items"),f.a.createElement("button",{onClick:Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,r.markItemsAsRead(l.randomItems.map((function(e){return e.id})));case 3:return e.next=5,r.loadItems({folderId:s});case 5:h(!1);case 6:case"end":return e.stop()}}),e)}))),disabled:g,style:{flex:1}},"mark them as read"),f.a.createElement("button",{onClick:function(){h(!0),r.loadItems({folderId:s,reloadRandomItems:!0}),h(!1)},disabled:g,style:{flex:1}},"reload random items")))}))},105:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n(19),o=n(23),i=n.n(o),s=n(42),c=n.n(s),l=n(12),u=n(18),d=n.n(u),m=n(0),f=n.n(m),v=n(5),p=n(24);t.default=Object(l.a)((function(e){var t,n,o,l,u,m,b,g=Object(v.c)(),h=d.a.parse(e.location.search.slice(1)),x=h.folderId,k=h.id;f.a.useEffect((function(){g.loadItems({folderId:x})}),[g,g.token,x]);var y=null===(t=g.folders)||void 0===t?void 0:t.find((function(e){return e.id===x})),w=null===y||void 0===y||null===(n=y.randomItems)||void 0===n?void 0:n.find((function(e){return e.id===k})),E=f.a.useState(!1),I=Object(a.a)(E,2),j=I[0],O=I[1],S=null;if(null===w||void 0===w||null===(o=w.summary)||void 0===o?void 0:o.content){var C=[{shouldPreprocessNode:function(e){return"img"===e.name},preprocessNode:function(e){var t;e.attribs=Object(r.a)({},e.attribs,{style:"".concat((null===(t=e.attribs)||void 0===t?void 0:t.style)||"","; max-width: 100%; height: auto;")})}},{shouldPreprocessNode:function(e){return"pre"===e.name},preprocessNode:function(e){var t;e.attribs=Object(r.a)({},e.attribs,{style:"".concat((null===(t=e.attribs)||void 0===t?void 0:t.style)||"",";\n              border: 1px solid lightgray;\n              padding: 2px;\n              overflow-x: auto;\n              white-space: pre;\n              font-size: 0.8rem;\n            ")})}}],N=[{shouldProcessNode:function(e){return!0},processNode:new c.a.ProcessNodeDefinitions(f.a).processDefaultNode}];S=(new s.Parser).parseWithInstructions(w.summary.content,(function(){return!0}),N,C)}return f.a.createElement("div",{className:"flex-column"},f.a.createElement("a",{href:null===w||void 0===w||null===(l=w.canonical)||void 0===l||null===(u=l[0])||void 0===u?void 0:u.href,target:"_blank",rel:"noopener noreferrer",className:"flex-column",style:{background:"lightgray",padding:8}},f.a.createElement("div",{style:{fontWeight:"bold"}},null===w||void 0===w?void 0:w.title),f.a.createElement("div",{className:"flex-row align-center",style:{marginTop:8,justifyContent:"space-between",fontSize:12,color:"gray"}},f.a.createElement("div",null,null===w||void 0===w||null===(m=w.origin)||void 0===m?void 0:m.title," | ",null===w||void 0===w?void 0:w.author),f.a.createElement("div",null,i()(1e3*(null===w||void 0===w?void 0:w.updated)).format("YYYY-MM-DD HH:mm")))),f.a.createElement("div",{style:{margin:8}},S||f.a.createElement("div",{dangerouslySetInnerHTML:{__html:null===w||void 0===w||null===(b=w.summary)||void 0===b?void 0:b.content}})),f.a.createElement("div",{style:{height:50}}),f.a.createElement("div",{className:"flex-row",style:{position:"fixed",bottom:0,left:0,right:0,zIndex:7,height:50}},f.a.createElement(p.a,{item:w,history:e.history,isSubmitting:j,setIsSubmitting:O,buttonStyle:{flex:1}})))}))},156:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),o=n(9),i=n(4),s=n(19),c=n(12),l=n(0),u=n.n(l),d=n(5);t.default=Object(c.a)((function(e){var t,n,r=Object(d.c)(),c=u.a.useState({account:null,password:null,isSubmitting:!1}),l=Object(s.a)(c,2),m=l[0],f=l[1];return u.a.createElement("div",{style:{margin:16,display:"grid",gridTemplateColumns:"auto 1fr",rowGap:16,columnGap:16}},u.a.createElement("div",null,"account"),u.a.createElement("input",{value:null!==(t=m.account)&&void 0!==t?t:"",onChange:function(e){return f(Object(i.a)({},m,{account:e.target.value||null}))}}),u.a.createElement("div",null,"password"),u.a.createElement("input",{value:null!==(n=m.password)&&void 0!==n?n:"",onChange:function(e){return f(Object(i.a)({},m,{password:e.target.value||null}))}}),u.a.createElement("button",{onClick:Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f(Object(i.a)({},m,{isSubmitting:!0})),t.next=3,r.login(m.account,m.password);case 3:if(!t.sent){t.next=5;break}e.history.goBack();case 5:f(Object(i.a)({},m,{isSubmitting:!1}));case 6:case"end":return t.stop()}}),t)}))),disabled:m.isSubmitting,style:{gridColumn:"1 / span 2",padding:8,fontSize:14}},"login"))}))},157:function(e,t,n){"use strict";n.r(t);var r=n(12),a=n(0),o=n.n(a),i=n(16),s=n(5);t.default=Object(r.a)((function(e){var t,n=Object(s.c)();return o.a.useEffect((function(){n.loadFolders()}),[n,n.token]),n.token?o.a.createElement("div",{className:"flex-column"},o.a.createElement("div",{style:{margin:"4px 4px 0"}},"\u672a\u8bfb\uff1a",n.totalUnreadCounts),null===(t=n.folders)||void 0===t?void 0:t.map((function(e){return o.a.createElement(i.b,{key:e.id,to:"/Folder?id=".concat(e.id),style:{margin:"4px 4px 0",border:"1px solid black",borderRadius:4,padding:8}},e.id," (",e.unreadCount,")")}))):o.a.createElement(i.b,{to:"/Login",style:{margin:8,border:"1px solid black",padding:16}},"login")}))},158:function(e,t,n){},159:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(11),i=n.n(o),s=n(5),c=n(2),l=n.n(c),u=n(9),d=n(12),m=n(16),f=n(3),v=n(13),p=(n(101),Object(d.a)((function(){var e=Object(s.c)();return a.a.useEffect((function(){(function(){var t=Object(u.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,localStorage.getItem("token");case 3:n=t.sent,e.loadToken(n),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.warn("App.loadToken error:",t.t0),Object(v.c)("load storage error: ".concat(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[e]),a.a.createElement("div",null,a.a.createElement(v.a,{autoClose:4e3,closeButton:!1,transition:Object(v.b)({enter:"slideInDown",exit:"slideOutUp",duration:300}),hideProgressBar:!0,toastClassName:"toast-border",bodyClassName:"toast-body"}),a.a.createElement(m.a,null,a.a.createElement(f.c,null,a.a.createElement(f.a,{path:"/Folder",component:n(104).default}),a.a.createElement(f.a,{path:"/Item",component:n(105).default}),a.a.createElement(f.a,{path:"/Login",component:n(156).default}),a.a.createElement(f.a,{path:"/",component:n(157).default}))))})));n(158),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(s.a.Provider,{value:new s.b},a.a.createElement(p,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},24:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(4),a=n(2),o=n.n(a),i=n(9),s=n(0),c=n.n(s),l=n(5);function u(e){var t,n,a=Object(l.c)(),u=e.item,d=e.isSubmitting,m=e.setIsSubmitting;return c.a.createElement(s.Fragment,null,c.a.createElement("button",{onClick:Object(i.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m(!0),t.next=3,a.markItemsAsRead([null===u||void 0===u?void 0:u.id]);case 3:if(!t.sent){t.next=5;break}(null===(n=e.history)||void 0===n?void 0:n.goBack)&&e.history.goBack();case 5:m(!1);case 6:case"end":return t.stop()}}),t)}))),disabled:d,style:Object(r.a)({},e.buttonStyle)},"mark as read"),c.a.createElement("a",{href:null===u||void 0===u||null===(t=u.canonical)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.href,target:"_blank",rel:"noopener noreferrer",className:"flex-row justify-center align-center",style:Object(r.a)({border:"1px solid lightgray",borderRadius:4,background:"white"},e.buttonStyle)},"original link"),c.a.createElement("button",{onClick:function(){var t;a.removeItems([null===u||void 0===u?void 0:u.id],"randomItems"),(null===(t=e.history)||void 0===t?void 0:t.goBack)&&e.history.goBack()},disabled:d,style:Object(r.a)({},e.buttonStyle)},"later"))}},5:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return E}));var r=n(4),a=n(38),o=n(2),i=n.n(o),s=n(70),c=n(71),l=n(1),u=n(0),d=n.n(u),m=n(13),f=n(9),v=n(72),p=n.n(v),b=n(18),g=n.n(b),h={},x=p.a.create({baseURL:"https://fever.glacjay.info",timeout:3e4});h.request=function(){var e=Object(f.a)(i.a.mark((function e(t,n,a,o){var s,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=Object(r.a)({},a),c=Object(r.a)({},h.token?{Authorization:"GoogleLogin auth=".concat(h.token)}:{}),e.next=5,x.request(Object(r.a)({method:t,url:n},"post"===t?{data:g.a.stringify(s)}:{params:s},{headers:c}));case 5:return l=e.sent.data,!1!==(null===o||void 0===o?void 0:o.log)&&console.log(t.toUpperCase(),n,a,l),e.abrupt("return",l);case 10:throw e.prev=10,e.t0=e.catch(0),console.warn(t.toUpperCase(),n,a,e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),h.get=function(){var e=Object(f.a)(i.a.mark((function e(t,n,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h.request("get",t,n,r));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),h.post=function(){var e=Object(f.a)(i.a.mark((function e(t,n,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h.request("post",t,n,r));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var k=h,y=function(){function e(){Object(s.a)(this,e),this.token=null,this.folders=null,l.l(this)}return Object(c.a)(e,[{key:"loadToken",value:function(e){this.token=e,k.token=e}},{key:"login",value:i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.post("/accounts/ClientLogin",{Email:t,Passwd:n});case 3:if(r=e.sent,a={},r.split("\n").filter((function(e){return e})).forEach((function(e){var t=e.indexOf("=");t>0?a[e.substr(0,t)]=e.substr(t+1):a[e]=!0})),a.Auth){e.next=8;break}throw new Error("account or password incorrect");case 8:return this.token=a.Auth,e.next=11,localStorage.setItem("token",this.token);case 11:return k.token=this.token,e.abrupt("return",!0);case 15:return e.prev=15,e.t0=e.catch(0),console.warn("RootStore.login error:",e.t0),Object(m.c)("login failed: ".concat(e.t0)),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,this,[[0,15]])}))},{key:"loadFolders",value:i.a.mark((function e(){var t,n,r,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.token){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,k.get("/reader/api/0/tag/list?output=json");case 5:return this.folders=e.sent.tags.filter((function(e){return/\/label\//.test(e.id)})),e.next=8,k.get("/reader/api/0/unread-count?output=json");case 8:t=e.sent,this.totalUnreadCounts=t.bq_total_unreads,n=t.unreadcounts,r=Object(a.a)(this.folders);try{for(s=function(){var e,t=o.value,r=null===(e=t.id)||void 0===e?void 0:e.replace(/\d+/,"-"),a=n.find((function(e){return e.id===r}));a&&(t.unreadCount=a.count)},r.s();!(o=r.n()).done;)s()}catch(i){r.e(i)}finally{r.f()}e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.warn("RootStore.loadFolders error:",e.t0),Object(m.c)("load folders error: ".concat(e.t0));case 19:case"end":return e.stop()}}),e,this,[[0,15]])}))},{key:"loadItems",value:i.a.mark((function e(t){var n,a,o,s,c,l,u,d,f,v,p,b,g,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.folderId,a=t.reloadItems,o=t.reloadRandomItems,e.prev=1,this.token&&n){e.next=4;break}return e.abrupt("return");case 4:if(this.folders){e.next=7;break}return e.next=7,this.loadFolders();case 7:if(f=null===(s=this.folders)||void 0===s?void 0:s.find((function(e){return e.id===n}))){e.next=10;break}return e.abrupt("return");case 10:if(a&&(f.items=null),(a||o)&&(f.randomItems=null),v=f.items,(null===(c=v)||void 0===c?void 0:c.length)>0||a){e.next=18;break}return e.next=16,localStorage.getItem("items:"+n);case 16:(p=e.sent)&&(v=JSON.parse(p),f.items=v);case 18:if((null===(l=v)||void 0===l?void 0:l.length)>0&&!a){e.next=25;break}return e.next=21,k.get("/reader/api/0/stream/items/ids",{output:"json",s:n,xt:"user/-/state/com.google/read",r:"o",n:1e4});case 21:return v=e.sent.itemRefs,f.items=v,e.next=25,localStorage.setItem("items:"+n,JSON.stringify(v));case 25:if(b=f.randomItems,(null===(u=b)||void 0===u?void 0:u.length)>0||o){e.next=31;break}return e.next=29,localStorage.getItem("randomItems:"+n);case 29:(g=e.sent)&&(b=JSON.parse(g),f.randomItems=b);case 31:if((null===(d=b)||void 0===d?void 0:d.length)>0&&!a&&!o){e.next=39;break}return h=Array.from(new Set(Array(7).fill().map((function(){return parseInt(Math.random()*v.length)})))),e.next=35,k.get("/reader/api/0/stream/items/contents?output=json".concat(h.map((function(e){return"&i=".concat(v[e].id)})).join("")));case 35:return b=e.sent.items.map((function(e,t){return Object(r.a)({},e,{id:v[t].id})})),f.randomItems=b,e.next=39,localStorage.setItem("randomItems:"+n,JSON.stringify(b));case 39:e.next=45;break;case 41:e.prev=41,e.t0=e.catch(1),console.warn("RootStore.loadItems error:",e.t0),Object(m.c)("load items error: ".concat(e.t0));case 45:case"end":return e.stop()}}),e,this,[[1,41]])}))},{key:"markItemsAsRead",value:i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.token&&(null===t||void 0===t?void 0:t.length)>0){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,k.post("/reader/api/0/edit-tag?".concat(t.map((function(e){return"i=".concat(e)})).join("&")),{a:"user/-/state/com.google/read"});case 5:return e.next=7,this.removeItems(t,"items");case 7:return e.next=9,this.removeItems(t,"randomItems");case 9:return e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(0),console.warn("RootStore.markItemsAsRead error:",e.t0),Object(m.c)("mark item as read error: ".concat(e.t0)),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[0,12]])}))},{key:"removeItems",value:i.a.mark((function e(t,n){var r,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(a.a)(this.folders||[]),e.prev=1,r.s();case 3:if((o=r.n()).done){e.next=11;break}if(c=o.value,!(null===(s=c[n])||void 0===s?void 0:s.some((function(e){return t.includes(e.id)})))){e.next=9;break}return c[n]=c[n].filter((function(e){return!t.includes(e.id)})),e.next=9,localStorage.setItem("".concat(n,":").concat(c.id),JSON.stringify(c[n]));case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))}]),e}(),w=d.a.createContext(null);function E(){return d.a.useContext(w)}},74:function(e,t,n){e.exports=n(159)}},[[74,1,2]]]);
//# sourceMappingURL=main.8a833e7f.chunk.js.map