(this["webpackJsonprandom-feeds"]=this["webpackJsonprandom-feeds"]||[]).push([[0],{108:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),o=n(9),i=n(24),s=n(1),c=n(28),l=n.n(c),u=n(16),d=n(23),f=n.n(d),b=n(0),v=n.n(b),m=n(21),p=n(7),h=n(29);t.default=Object(u.a)((function(e){var t,n,r,c=Object(p.c)(),u=f.a.parse(e.location.search.slice(1)).id,d=null===(t=c.folders)||void 0===t?void 0:t.find((function(e){return e.id===u}));v.a.useEffect((function(){c.loadItems({folderId:u})}),[c,c.token,u]);var b=v.a.useState(!1),j=Object(i.a)(b,2),x=j[0],g=j[1];return Object(s.jsxs)("div",{className:"flex-column",style:{paddingBottom:4},children:[Object(s.jsxs)("div",{style:{margin:"4px 4px 0"},children:[null===d||void 0===d?void 0:d.id,"\uff1a",null===d||void 0===d||null===(n=d.items)||void 0===n?void 0:n.length,"/",null===d||void 0===d?void 0:d.unreadCount]}),null===d||void 0===d||null===(r=d.randomItems)||void 0===r?void 0:r.map((function(e){var t;return Object(s.jsxs)("div",{style:{margin:4,marginBottom:0,border:"1px solid black",borderRadius:4,padding:8},children:[Object(s.jsxs)(m.b,{to:"/Item?folderId=".concat(u,"&id=").concat(e.id),children:[Object(s.jsx)("div",{children:e.title}),Object(s.jsxs)("div",{className:"flex-row align-center",style:{marginTop:8,justifyContent:"space-between",fontSize:12,color:"gray"},children:[Object(s.jsxs)("div",{children:[null===(t=e.origin)||void 0===t?void 0:t.title," | ",e.author]}),Object(s.jsx)("div",{children:l()(1e3*e.updated).format("YYYY-MM-DD HH:mm")})]})]}),Object(s.jsx)("div",{className:"flex-row align-center",style:{marginTop:8,justifyContent:"flex-end"},children:Object(s.jsx)(h.a,{folderId:u,item:e,isSubmitting:x,setIsSubmitting:g})})]},e.id)})),Object(s.jsx)("div",{style:{height:50}}),Object(s.jsxs)("div",{className:"flex-row",style:{position:"fixed",bottom:0,left:0,right:0,zIndex:7,height:50},children:[Object(s.jsx)("button",{onClick:function(){g(!0),c.loadItems({folderId:u,reloadItems:!0}),g(!1)},disabled:x,style:{flex:1},children:"reload folder items"}),Object(s.jsx)("button",{onClick:Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.next=3,c.markItemsAsRead(d.randomItems.map((function(e){return e.id})));case 3:return e.next=5,c.loadItems({folderId:u});case 5:g(!1);case 6:case"end":return e.stop()}}),e)}))),disabled:x,style:{flex:1},children:"mark them as read"}),Object(s.jsx)("button",{onClick:function(){g(!0),c.loadItems({folderId:u,reloadRandomItems:!0}),g(!1)},disabled:x,style:{flex:1},children:"reload random items"})]})]})}))},109:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n(24),o=n(1),i=n(28),s=n.n(i),c=n(48),l=n.n(c),u=n(16),d=n(23),f=n.n(d),b=n(0),v=n.n(b),m=n(7),p=n(29);t.default=Object(u.a)((function(e){var t,n,i,u,d,b,h,j=Object(m.c)(),x=f.a.parse(e.location.search.slice(1)),g=x.folderId,O=x.id;v.a.useEffect((function(){j.loadItems({folderId:g})}),[j,j.token,g]);var k=null===(t=j.folders)||void 0===t?void 0:t.find((function(e){return e.id===g})),y=null===k||void 0===k||null===(n=k.randomItems)||void 0===n?void 0:n.find((function(e){return e.id===O})),w=v.a.useState(!1),I=Object(a.a)(w,2),S=I[0],C=I[1],N=null;if(null===y||void 0===y||null===(i=y.summary)||void 0===i?void 0:i.content){var R=[{shouldPreprocessNode:function(e){return"img"===e.name},preprocessNode:function(e){var t;e.attribs=Object(r.a)(Object(r.a)({},e.attribs),{},{style:"".concat((null===(t=e.attribs)||void 0===t?void 0:t.style)||"","; max-width: 100%; height: auto;")})}},{shouldPreprocessNode:function(e){return"pre"===e.name},preprocessNode:function(e){var t;e.attribs=Object(r.a)(Object(r.a)({},e.attribs),{},{style:"".concat((null===(t=e.attribs)||void 0===t?void 0:t.style)||"",";\n              border: 1px solid lightgray;\n              padding: 2px;\n              overflow-x: auto;\n              white-space: pre;\n              font-size: 0.8rem;\n            ")})}}],B=[{shouldProcessNode:function(e){return!0},processNode:new l.a.ProcessNodeDefinitions(v.a).processDefaultNode}];N=(new c.Parser).parseWithInstructions(y.summary.content,(function(){return!0}),B,R)}return Object(o.jsxs)("div",{className:"flex-column",children:[Object(o.jsxs)("a",{href:null===y||void 0===y||null===(u=y.canonical)||void 0===u||null===(d=u[0])||void 0===d?void 0:d.href,target:"_blank",rel:"noopener noreferrer",className:"flex-column",style:{background:"lightgray",padding:8},children:[Object(o.jsx)("div",{style:{fontWeight:"bold"},children:null===y||void 0===y?void 0:y.title}),Object(o.jsxs)("div",{className:"flex-row align-center",style:{marginTop:8,justifyContent:"space-between",fontSize:12,color:"gray"},children:[Object(o.jsxs)("div",{children:[null===y||void 0===y||null===(b=y.origin)||void 0===b?void 0:b.title," | ",null===y||void 0===y?void 0:y.author]}),Object(o.jsx)("div",{children:s()(1e3*(null===y||void 0===y?void 0:y.updated)).format("YYYY-MM-DD HH:mm")})]})]}),Object(o.jsx)("div",{style:{margin:8},children:N||Object(o.jsx)("div",{dangerouslySetInnerHTML:{__html:null===y||void 0===y||null===(h=y.summary)||void 0===h?void 0:h.content}})}),Object(o.jsx)("div",{style:{height:50}}),Object(o.jsx)("div",{className:"flex-row",style:{position:"fixed",bottom:0,left:0,right:0,zIndex:7,height:50},children:Object(o.jsx)(p.a,{folderId:g,item:y,history:e.history,isSubmitting:S,setIsSubmitting:C,buttonStyle:{flex:1}})})]})}))},14:function(e,t,n){"use strict";var r=n(3),a=n.n(r),o=n(4),i=n(9),s=n(76),c=n.n(s),l=n(23),u=n.n(l),d={},f=c.a.create({baseURL:"https://fever.glacjay.info",timeout:3e4});d.request=function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i){var s,c,l,b,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=Object(o.a)({},r),c=Object(o.a)({},d.token?{Authorization:"GoogleLogin auth=".concat(d.token)}:{}),e.next=5,f.request(Object(o.a)(Object(o.a)({method:t,url:n},"post"===t?{data:u.a.stringify(s)}:{params:s}),{},{headers:c}));case 5:return l=e.sent.data,!1!==(null===i||void 0===i?void 0:i.log)&&console.log(t.toUpperCase(),n,r,l),e.abrupt("return",l);case 10:if(e.prev=10,e.t0=e.catch(0),console.warn(t.toUpperCase(),n,r,e.t0),401!==(null===e.t0||void 0===e.t0||null===(b=e.t0.response)||void 0===b?void 0:b.status)){e.next=17;break}return d.token=null,(null===(v=d.history)||void 0===v?void 0:v.push)&&d.history.push("/Login"),e.abrupt("return");case 17:throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),d.get=function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.request("get",t,n,r));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),d.post=function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.request("post",t,n,r));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.a=d},160:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),o=n(9),i=n(4),s=n(24),c=n(1),l=n(16),u=n(0),d=n.n(u),f=n(7);t.default=Object(l.a)((function(e){var t,n,r=Object(f.c)(),l=d.a.useState({account:null,password:null,isSubmitting:!1}),u=Object(s.a)(l,2),b=u[0],v=u[1];return Object(c.jsxs)("div",{style:{margin:16,display:"grid",gridTemplateColumns:"auto 1fr",rowGap:16,columnGap:16},children:[Object(c.jsx)("div",{children:"account"}),Object(c.jsx)("input",{value:null!==(t=b.account)&&void 0!==t?t:"",onChange:function(e){return v(Object(i.a)(Object(i.a)({},b),{},{account:e.target.value||null}))}}),Object(c.jsx)("div",{children:"password"}),Object(c.jsx)("input",{value:null!==(n=b.password)&&void 0!==n?n:"",onChange:function(e){return v(Object(i.a)(Object(i.a)({},b),{},{password:e.target.value||null}))}}),Object(c.jsx)("button",{onClick:Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v(Object(i.a)(Object(i.a)({},b),{},{isSubmitting:!0})),t.next=3,r.login(b.account,b.password);case 3:if(!t.sent){t.next=5;break}e.history.goBack();case 5:v(Object(i.a)(Object(i.a)({},b),{},{isSubmitting:!1}));case 6:case"end":return t.stop()}}),t)}))),disabled:b.isSubmitting,style:{gridColumn:"1 / span 2",padding:8,fontSize:14},children:"login"})]})}))},161:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(16),o=n(0),i=n.n(o),s=n(21),c=n(7);t.default=Object(a.a)((function(e){var t,n=Object(c.c)();return i.a.useEffect((function(){n.loadFolders()}),[n,n.token]),n.token?Object(r.jsxs)("div",{className:"flex-column",children:[Object(r.jsxs)("div",{style:{margin:"4px 4px 0"},children:["\u672a\u8bfb\uff1a",n.totalUnreadCounts]}),null===(t=n.folders)||void 0===t?void 0:t.map((function(e){return Object(r.jsxs)(s.b,{to:"/Folder?id=".concat(e.id),style:{margin:"4px 4px 0",border:"1px solid black",borderRadius:4,padding:8},children:[e.id," (",e.unreadCount,")"]},e.id)}))]}):Object(r.jsx)(s.b,{to:"/Login",style:{margin:8,border:"1px solid black",padding:16},children:"login"})}))},162:function(e,t,n){},163:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),o=n.n(a),i=n(15),s=n.n(i),c=n(7),l=n(3),u=n.n(l),d=n(9),f=n(16),b=n(21),v=n(5),m=n(17),p=(n(105),n(14)),h=Object(f.a)((function(){var e=Object(c.c)();return o.a.useEffect((function(){(function(){var t=Object(d.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,localStorage.getItem("token");case 3:n=t.sent,e.loadToken(n),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.warn("App.loadToken error:",t.t0),Object(m.c)("load storage error: ".concat(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(r.jsxs)("div",{children:[Object(r.jsx)(m.a,{autoClose:4e3,closeButton:!1,transition:Object(m.b)({enter:"slideInDown",exit:"slideOutUp",duration:300}),hideProgressBar:!0,toastClassName:"toast-border",bodyClassName:"toast-body"}),Object(r.jsxs)(b.a,{children:[Object(r.jsx)(j,{}),Object(r.jsxs)(v.c,{children:[Object(r.jsx)(v.a,{path:"/Folder",component:n(108).default}),Object(r.jsx)(v.a,{path:"/Item",component:n(109).default}),Object(r.jsx)(v.a,{path:"/Login",component:n(160).default}),Object(r.jsx)(v.a,{path:"/",component:n(161).default})]})]})]})}));function j(){var e=Object(v.f)();return o.a.useEffect((function(){p.a.history=e}),[e]),null}n(162),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(c.a.Provider,{value:new c.b,children:Object(r.jsx)(h,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},29:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(4),a=n(3),o=n.n(a),i=n(9),s=n(1),c=n(0),l=n(7);function u(e){var t,n,a=Object(l.c)(),u=e.folderId,d=e.item,f=e.isSubmitting,b=e.setIsSubmitting;return Object(s.jsxs)(c.Fragment,{children:[Object(s.jsx)("button",{onClick:Object(i.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b(!0),t.next=3,a.markItemsAsRead([null===d||void 0===d?void 0:d.id]);case 3:if(!t.sent){t.next=5;break}(null===(n=e.history)||void 0===n?void 0:n.goBack)?e.history.goBack():a.loadItems({folderId:u});case 5:b(!1);case 6:case"end":return t.stop()}}),t)}))),disabled:f,style:Object(r.a)({padding:"4px 8px"},e.buttonStyle),children:"mark as read"}),Object(s.jsx)("a",{href:null===d||void 0===d||null===(t=d.canonical)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.href,target:"_blank",rel:"noopener noreferrer",className:"flex-row justify-center align-center",style:Object(r.a)({border:"1px solid lightgray",borderRadius:4,background:"white",padding:"4px 8px"},e.buttonStyle),children:"original link"}),Object(s.jsx)("button",{onClick:function(){var t;a.removeItems([null===d||void 0===d?void 0:d.id],"randomItems"),(null===(t=e.history)||void 0===t?void 0:t.goBack)&&e.history.goBack()},disabled:f,style:Object(r.a)({padding:"4px 8px"},e.buttonStyle),children:"later"})]})}},7:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return h}));var r=n(4),a=n(9),o=n(45),i=n(3),s=n.n(i),c=n(74),l=n(75),u=n(2),d=n(0),f=n.n(d),b=n(17),v=n(14),m=function(){function e(){Object(c.a)(this,e),this.token=null,this.folders=null,u.l(this)}return Object(l.a)(e,[{key:"loadToken",value:function(e){this.token=e,v.a.token=e}},{key:"login",value:s.a.mark((function e(t,n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post("/accounts/ClientLogin",{Email:t,Passwd:n});case 3:if(r=e.sent,a={},r.split("\n").filter((function(e){return e})).forEach((function(e){var t=e.indexOf("=");t>0?a[e.substr(0,t)]=e.substr(t+1):a[e]=!0})),a.Auth){e.next=8;break}throw new Error("account or password incorrect");case 8:return this.token=a.Auth,e.next=11,localStorage.setItem("token",this.token);case 11:return v.a.token=this.token,e.abrupt("return",!0);case 15:return e.prev=15,e.t0=e.catch(0),console.warn("RootStore.login error:",e.t0),Object(b.c)("login failed: ".concat(e.t0)),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,this,[[0,15]])}))},{key:"loadFolders",value:s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.token){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,v.a.get("/reader/api/0/tag/list?output=json");case 5:return this.folders=e.sent.tags.filter((function(e){return/\/label\//.test(e.id)})),e.next=8,this.loadUnreadCounts(this.folders);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.warn("RootStore.loadFolders error:",e.t0),Object(b.c)("load folders error: ".concat(e.t0));case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))},{key:"loadUnreadCounts",value:s.a.mark((function e(t){var n,r,a,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("/reader/api/0/unread-count?output=json");case 2:n=e.sent,this.totalUnreadCounts=n.bq_total_unreads,r=n.unreadcounts,a=Object(o.a)(t);try{for(c=function(){var e,t=i.value,n=null===(e=t.id)||void 0===e?void 0:e.replace(/\d+/,"-"),a=r.find((function(e){return e.id===n}));a&&(t.unreadCount=a.count)},a.s();!(i=a.n()).done;)c()}catch(s){a.e(s)}finally{a.f()}case 7:case"end":return e.stop()}}),e,this)}))},{key:"loadItems",value:s.a.mark((function e(t){var n,o,i,c,l,u,d,f,m,p,h,j,x,g,O,k,y;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.folderId,o=t.reloadItems,i=t.reloadRandomItems,e.prev=1,this.token&&n){e.next=4;break}return e.abrupt("return");case 4:if(this.folders){e.next=7;break}return e.next=7,this.loadFolders();case 7:if(j=null===(c=this.folders)||void 0===c?void 0:c.find((function(e){return e.id===n}))){e.next=10;break}return e.abrupt("return");case 10:if(!o){e.next=13;break}return e.next=13,this.loadUnreadCounts([j]);case 13:if(o&&(j.items=null),(o||i)&&(j.randomItems=null),x=j.items,(null===(l=x)||void 0===l?void 0:l.length)>0||o){e.next=21;break}return e.next=19,localStorage.getItem("items:"+n);case 19:(g=e.sent)&&(x=JSON.parse(g),j.items=x);case 21:if((null===(u=x)||void 0===u?void 0:u.length)>0&&!o&&((null===(d=j.randomItems)||void 0===d?void 0:d.length)>0||!(Math.random()<1/((null===(f=x)||void 0===f?void 0:f.length)||1)))){e.next=28;break}return e.next=24,v.a.get("/reader/api/0/stream/items/ids",{output:"json",s:n,xt:"user/-/state/com.google/read",r:"o",n:5e3});case 24:return x=e.sent.itemRefs,j.items=x,e.next=28,localStorage.setItem("items:"+n,JSON.stringify(x));case 28:if(O=j.randomItems,(null===(m=O)||void 0===m?void 0:m.length)>0||i){e.next=34;break}return e.next=32,localStorage.getItem("randomItems:"+n);case 32:(k=e.sent)&&(O=JSON.parse(k),j.randomItems=O);case 34:if(!((null===(p=x)||void 0===p?void 0:p.length)>0)||(null===(h=O)||void 0===h?void 0:h.length)>0&&!o&&!i){e.next=42;break}return y=Array.from(new Set(Array(7).fill().map((function(){return parseInt(Math.random()*x.length)})))),e.next=38,Promise.all(y.map(function(){var e=Object(a.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r.a,e.t1=r.a,e.t2={},e.next=5,v.a.get("/reader/api/0/stream/items/contents?output=json&i=".concat(x[t].id));case 5:return e.t3=e.sent.items[0],e.t4=(0,e.t1)(e.t2,e.t3),e.t5={},e.t6={id:x[t].id},e.abrupt("return",(0,e.t0)(e.t4,e.t5,e.t6));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 38:return O=e.sent,j.randomItems=O,e.next=42,localStorage.setItem("randomItems:"+n,JSON.stringify(O));case 42:e.next=48;break;case 44:e.prev=44,e.t0=e.catch(1),console.warn("RootStore.loadItems error:",e.t0),Object(b.c)("load items error: ".concat(e.t0));case 48:case"end":return e.stop()}}),e,this,[[1,44]])}))},{key:"markItemsAsRead",value:s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.token&&(null===t||void 0===t?void 0:t.length)>0){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,v.a.post("/reader/api/0/edit-tag?".concat(t.map((function(e){return"i=".concat(e)})).join("&")),{a:"user/-/state/com.google/read"});case 5:return e.next=7,this.removeItems(t,"items");case 7:return e.next=9,this.removeItems(t,"randomItems");case 9:return e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(0),console.warn("RootStore.markItemsAsRead error:",e.t0),Object(b.c)("mark item as read error: ".concat(e.t0)),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[0,12]])}))},{key:"removeItems",value:s.a.mark((function e(t,n){var r,a,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(o.a)(this.folders||[]),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=11;break}if(c=a.value,!(null===(i=c[n])||void 0===i?void 0:i.some((function(e){return t.includes(e.id)})))){e.next=9;break}return c[n]=c[n].filter((function(e){return!t.includes(e.id)})),e.next=9,localStorage.setItem("".concat(n,":").concat(c.id),JSON.stringify(c[n]));case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))}]),e}(),p=f.a.createContext(null);function h(){return f.a.useContext(p)}}},[[163,1,2]]]);
//# sourceMappingURL=main.f6ce3710.chunk.js.map